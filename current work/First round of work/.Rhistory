library(survival)
?diabetic
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(INLA)
library(survival)
head(as_tibble(diabetic))
?bladder1
data <- as_tibble(bladder1)
data <- select(data,-c(rsize,rtumor,enum))
data <- data %>% mutate(censored = status==0)
for (i in 1:length(data$censored)) {
if(data$censored[i]) data$censored[i] <- 1
else data$censored[i] <- 0
}
data <- data %>% mutate(times = stop-start)
head(data)
tail(data)
data <- as_tibble(bladder1)
data <- select(data,-c(rsize,rtumor,enum))
data <- data %>% mutate(censored = status==0)
for (i in 1:length(data$censored)) {
if(data$censored[i]) data$censored[i] <- 0
else data$censored[i] <- 1
}
data <- data %>% mutate(times = stop-start)
head(data)
tail(data)
bladder.CoxPh <- coxph(Surv(times, censored)~ number + size + recur + frailty.gaussian(id), data = data)
summary(bladder.CoxPh)
formula = inla.surv(times, censored) ~  number + size + recur + f(id, model = "iid")
bladder.INLA <- inla(formula, control.compute = list(dic = TRUE), family = "coxph",
data = data, control.hazard=list(model="rw2", n.intervals=20))
bladder.INLA$summary.fixed
8.6e-01
2.7e-19
formula = inla.surv(times, censored) ~  number + size + recur + f(id, model = "iid")
bladder.INLA <- inla(formula, control.compute = list(dic = TRUE), family = "coxph",
data = data, control.hazard=list(model="rw2", n.intervals=20))
bladder.INLA$summary.fixed
((126-148.665)^2)/148.665 + ((475-452.355)^2)/452.355 + ((53-35.156)^2)/35.156 + ((89-106.972)^2)/106.972 + ((8-3.179)^2)/3.179 + ((5-9.673)^2)/9.673
pchisq(26.23,df=2)
pchisq(26.23,df=2,lower.tail = F)
